# Руководство по настройке онлайн-кассы для Кипра

## Обзор

Этот документ содержит пошаговые инструкции по настройке интеграции с онлайн-кассой для вашего приложения кофейни на Кипре.

## Требования

### 1. Регистрация бизнеса на Кипре
- Зарегистрируйте компанию в Реестре компаний Кипра
- Получите VAT номер (формат: CY12345678X)
- Зарегистрируйтесь в налоговой службе Кипра

### 2. Выбор провайдера онлайн-кассы
Рекомендуемые провайдеры для Кипра:
- **Cyprus Tax Authority POS** (официальная система)
- **Square** (международный провайдер)
- **SumUp** (европейский провайдер)
- **Local POS providers** (местные поставщики)

## Настройка

### Шаг 1: Конфигурация API

Откройте файл `pos-config.js` и заполните следующие поля:

```javascript
const POS_CONFIG = {
    // Основные настройки кассы
    cashRegister: {
        id: 'YOUR_CASH_REGISTER_ID', // Получите у провайдера
        name: 'Art Coffee POS',
        location: 'Nicosia, Cyprus'
    },
    
    // API настройки
    api: {
        baseUrl: 'https://api.your-provider.com/v1', // URL вашего провайдера
        apiKey: 'YOUR_API_KEY', // API ключ от провайдера
        timeout: 30000,
        retryAttempts: 3
    },
    
    // Информация о бизнесе
    business: {
        name: 'Art Coffee',
        legalName: 'Art Coffee Ltd',
        address: {
            street: 'Your Street Address',
            city: 'Nicosia',
            postalCode: '1000',
            country: 'Cyprus'
        },
        vatNumber: 'CY12345678X', // Ваш VAT номер
        registrationNumber: 'HE123456', // Регистрационный номер
        phone: '+357 22 123456',
        email: 'info@artcoffee.cy',
        website: 'https://artcoffee.cy'
    }
};
```

### Шаг 2: Получение API ключей

1. **Зарегистрируйтесь у провайдера онлайн-кассы**
2. **Создайте приложение** в панели управления провайдера
3. **Получите API ключи**:
   - API Key (для аутентификации)
   - Cash Register ID (идентификатор кассы)
   - Webhook URL (для уведомлений)

### Шаг 3: Настройка веб-хуков

Настройте веб-хуки для получения уведомлений о статусе чеков:

```javascript
// Добавьте в pos-config.js
webhooks: {
    receiptCreated: 'https://yourdomain.com/webhook/receipt-created',
    receiptFailed: 'https://yourdomain.com/webhook/receipt-failed',
    receiptPrinted: 'https://yourdomain.com/webhook/receipt-printed'
}
```

### Шаг 4: Тестирование

1. **Включите тестовый режим**:
   ```javascript
   integration: {
       mode: 'test' // Измените на 'production' для продакшена
   }
   ```

2. **Проверьте подключение**:
   - Откройте консоль браузера
   - Проверьте сообщения о подключении к POS системе

3. **Создайте тестовый заказ**:
   - Добавьте товары в корзину
   - Оформите заказ
   - Проверьте создание чека

## Налоговые требования

### НДС на Кипре
- **Стандартная ставка**: 19%
- **Пониженная ставка**: 9% (для некоторых товаров)
- **Нулевая ставка**: 0% (для экспорта)

### Обязательная информация в чеке
- Название и адрес бизнеса
- VAT номер
- Номер чека
- Дата и время
- Детали товаров/услуг
- Сумма НДС
- Общая сумма

## Безопасность

### Рекомендации
1. **Никогда не храните API ключи в коде**
2. **Используйте HTTPS** для всех запросов
3. **Регулярно обновляйте ключи**
4. **Ведите логи** всех операций
5. **Используйте шифрование** для чувствительных данных

### Настройка переменных окружения
```bash
# Создайте файл .env
POS_API_KEY=your_api_key_here
POS_CASH_REGISTER_ID=your_cash_register_id
POS_API_URL=https://api.your-provider.com/v1
```

## Мониторинг и отчетность

### Логирование
Система автоматически ведет логи:
- Успешных операций
- Ошибок подключения
- Созданных чеков
- Отправленных уведомлений

### Отчеты
- Ежедневные отчеты по продажам
- Налоговые отчеты
- Отчеты по ошибкам

## Устранение неполадок

### Частые проблемы

1. **Ошибка подключения к API**
   - Проверьте правильность API ключа
   - Убедитесь, что URL провайдера корректен
   - Проверьте интернет-соединение

2. **Ошибка создания чека**
   - Проверьте формат данных заказа
   - Убедитесь, что все обязательные поля заполнены
   - Проверьте лимиты API

3. **Проблемы с отправкой чеков**
   - Проверьте настройки email/SMS
   - Убедитесь в корректности контактных данных

### Логи для отладки
```javascript
// Включите подробное логирование
console.log('POS Debug Mode:', true);
```

## Поддержка

### Контакты
- **Техническая поддержка**: support@artcoffee.cy
- **Налоговые вопросы**: tax@artcoffee.cy
- **API документация**: [ссылка на документацию провайдера]

### Полезные ссылки
- [Cyprus Tax Authority](https://www.tax.gov.cy)
- [VAT Registration Guide](https://www.tax.gov.cy/vat-registration)
- [POS System Requirements](https://www.tax.gov.cy/pos-requirements)

## Обновления

Система поддерживает автоматические обновления:
- API версии
- Налоговые ставки
- Форматы чеков
- Безопасность

---

**Важно**: Всегда тестируйте изменения в тестовом режиме перед переходом в продакшен!
